{"version":3,"file":"social.min.js","sources":["../../../apps/frappe/frappe/public/js/frappe/social/components/PostAction.vue?rollup-plugin-vue=script.js","../../../apps/frappe/frappe/public/js/frappe/social/components/PostComment.vue?rollup-plugin-vue=script.js","../../../apps/frappe/frappe/public/js/frappe/social/components/PostDropdownMenu.vue?rollup-plugin-vue=script.js","../../../apps/frappe/frappe/public/js/frappe/social/components/Post.vue?rollup-plugin-vue=script.js","../../../apps/frappe/frappe/public/js/frappe/social/components/PostLoader.vue?rollup-plugin-vue=script.js","../../../apps/frappe/frappe/public/js/frappe/social/components/PostSidebar.vue?rollup-plugin-vue=script.js","../../../apps/frappe/frappe/public/js/frappe/social/components/ActivitySidebar.vue?rollup-plugin-vue=script.js","../../../apps/frappe/frappe/public/js/frappe/social/pages/Wall.vue?rollup-plugin-vue=script.js","../../../apps/frappe/frappe/public/js/frappe/social/components/ProfileSidebar.vue?rollup-plugin-vue=script.js","../../../apps/frappe/frappe/public/js/frappe/social/components/ProfileBanner.vue?rollup-plugin-vue=script.js","../../../apps/frappe/frappe/public/js/frappe/social/pages/Profile.vue?rollup-plugin-vue=script.js","../../../apps/frappe/frappe/public/js/frappe/social/pages/UserList.vue?rollup-plugin-vue=script.js","../../../apps/frappe/frappe/public/js/frappe/social/components/ImageViewer.vue?rollup-plugin-vue=script.js","../../../apps/frappe/frappe/public/js/frappe/social/Home.vue?rollup-plugin-vue=script.js","../../../apps/frappe/frappe/public/js/frappe/social/social_home.js"],"sourcesContent":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n\tprops: [\n\t\t'liked_by',\n\t\t'comment_count',\n\t],\n\tcomputed: {\n\t\tlike_count() {\n\t\t\treturn this.split_string(this.liked_by).length;\n\t\t},\n\t\tpost_liked() {\n\t\t\treturn this.split_string(this.liked_by).includes(frappe.session.user);\n\t\t},\n\t\tliked_by_data() {\n\t\t\treturn JSON.stringify(this.split_string(this.liked_by));\n\t\t}\n\t},\n\tmethods: {\n\t\tsplit_string(str) {\n\t\t\treturn str && str !== '' ? str.split('\\n') : []\n\t\t}\n\t}\n}\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n\tprops: ['comments'],\n\tmounted() {\n\t\tthis.make_comment_section();\n\t\tthis.make_mentions_clickable(this.$refs['comments']);\n\t},\n\tmethods: {\n\t\tget_avatar(user) {\n\t\t\treturn frappe.avatar(user)\n\t\t},\n\t\tget_time(timestamp) {\n\t\t\treturn comment_when(timestamp, true)\n\t\t},\n\t\tgo_to_profile_page(user) {\n\t\t\tfrappe.set_route('social', 'profile', user)\n\t\t},\n\t\tmake_comment_section() {\n\t\t\tthis.comment_section = frappe.ui.form.make_control({\n\t\t\t\tparent: this.$refs['comment-section'],\n\t\t\t\tonly_input: true,\n\t\t\t\trender_input: true,\n\t\t\t\tno_wrapper: true,\n\t\t\t\tmentions: this.get_names_for_mentions(),\n\t\t\t\tdf: {\n\t\t\t\t\tfieldtype: 'Comment',\n\t\t\t\t\tfieldname: 'comment'\n\t\t\t\t},\n\t\t\t\ton_submit: this.create_comment.bind(this)\n\t\t\t});\n\t\t},\n\t\tcreate_comment() {\n\t\t\tconst message = this.comment_section.get_value().replace('<div><br></div>', '');\n\t\t\tif (!strip_html(message)) return\n\t\t\tfrappe.utils.play_sound(\"click\");\n\t\t\tthis.$emit('create_comment', message);\n\t\t\tthis.comment_section.clear();\n\t\t},\n\t\tget_names_for_mentions() {\n\t\t\tvar valid_users = Object.keys(frappe.boot.user_info)\n\t\t\t\t.filter(user => ![\"Administrator\", \"Guest\"].includes(user));\n\t\t\tvalid_users = valid_users\n\t\t\t\t.filter(user => frappe.boot.user_info[user].allowed_in_mentions==1);\n\t\t\treturn valid_users.map(user => frappe.boot.user_info[user].name);\n\t\t},\n\t\tmake_mentions_clickable(parent_element) {\n\t\t\tArray.from(parent_element.getElementsByClassName('mention'))\n\t\t\t\t.forEach((mention) => {\n\t\t\t\t\tmention.classList.add('cursor-pointer');\n\t\t\t\t\tmention.addEventListener('click', () => {\n\t\t\t\t\t\tthis.go_to_profile_page(mention.dataset.value)\n\t\t\t\t\t})\n\t\t\t\t});\n\t\t}\n\t}\n}\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n\tprops: ['options'],\n}\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport PostAction from './PostAction.vue';\nimport PostComment from './PostComment.vue';\nimport PostDropdownMenu from './PostDropdownMenu.vue';\n\nexport default {\n\tprops: ['post'],\n\tcomponents: {\n\t\tPostAction,\n\t\tPostComment,\n\t\tPostDropdownMenu\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tuser_avatar: frappe.avatar(this.post.owner, 'avatar-medium'),\n\t\t\tpost_time: comment_when(this.post.creation),\n\t\t\tuser_name: frappe.user_info(this.post.owner).fullname,\n\t\t\tcomment_count: 0,\n\t\t\tcomments: [],\n\t\t\tshow_comments: false,\n\t\t\tis_globally_pinnable: frappe.user_roles.includes('System Manager') && frappe.social.is_home_page(),\n\t\t\tis_pinnable: false,\n\t\t\tis_user_post_owner: this.post.owner === frappe.session.user\n\t\t}\n\t},\n\tcomputed: {\n\t\tcan_pin() {\n\t\t\treturn this.is_globally_pinnable || this.is_pinnable\n\t\t},\n\t\tis_pinned() {\n\t\t\treturn false && frappe.social.is_profile_page(this.post.owner)\n\t\t\t\t|| this.post.is_globally_pinned && frappe.social.is_home_page()\n\t\t},\n\t\toptions() {\n\t\t\tconst options = []\n\t\t\tif (this.can_pin) {\n\t\t\t\tif (this.is_pinned) {\n\t\t\t\t\toptions.push({\n\t\t\t\t\t\t'label': __('Unpin'),\n\t\t\t\t\t\t'action': this.toggle_pin\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\toptions.push({\n\t\t\t\t\t\t'label': __('Pin Globally'),\n\t\t\t\t\t\t'action': this.toggle_pin\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.is_user_post_owner) {\n\t\t\t\toptions.push({\n\t\t\t\t\t'label': __('Delete'),\n\t\t\t\t\t'action': this.delete_post\n\t\t\t\t})\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t},\n\tcreated() {\n\t\tfrappe.db.get_list('Post Comment', {\n\t\t\tfields: ['name', 'content', 'owner', 'creation'],\n\t\t\torder_by: 'creation desc',\n\t\t\tfilters: {\n\t\t\t\tparent: this.post.name\n\t\t\t}\n\t\t}).then(comments => {\n\t\t\tthis.comments = comments;\n\t\t})\n\n\t\tif (!this.post.liked_by) {\n\t\t\tthis.$set(this.post, 'liked_by', '')\n\t\t}\n\n\t\tfrappe.realtime.on('new_post_comment' + this.post.name, (comment) => {\n\t\t\tthis.comments = [comment].concat(this.comments);\n\t\t})\n\t\tfrappe.realtime.on('update_liked_by' + this.post.name, this.update_liked_by)\n\n\t\tfrappe.realtime.on('delete_post' + this.post.name, () => {\n\t\t\tthis.$emit('delete-post')\n\t\t})\n\n\t\tthis.$root.$on('user_image_updated', () => {\n\t\t\tthis.user_avatar = frappe.avatar(this.post.owner, 'avatar-medium')\n\t\t})\n\n\t},\n\tmounted() {\n\t\tthis.$refs['content'].querySelectorAll('img').forEach((img) => {\n\t\t\timg.addEventListener('click', () => {\n\t\t\t\tthis.$root.$emit('show_preview', img.src);\n\t\t\t})\n\t\t});\n\n\t\tthis.$refs['content'].querySelectorAll('a').forEach(link_element => {\n\t\t\t// to open link in new tab\n\t\t\tlink_element.target = 'blank';\n\t\t\tthis.generate_preview(link_element);\n\t\t})\n\t},\n\tmethods: {\n\t\tgoto_profile(user) {\n\t\t\tfrappe.set_route('social', 'profile/' + user)\n\t\t},\n\t\ttoggle_comment() {\n\t\t\tthis.show_comments = !this.show_comments\n\t\t},\n\t\tupdate_liked_by(liked_by) {\n\t\t\tthis.post.liked_by = liked_by;\n\t\t},\n\t\ttoggle_like() {\n\t\t\tfrappe.xcall('frappe.social.doctype.post.post.toggle_like', {\n\t\t\t\tpost_name: this.post.name,\n\t\t\t})\n\t\t},\n\t\ttoggle_pin() {\n\t\t\tif (this.is_globally_pinnable) {\n\t\t\t\tfrappe.db.set_value('Post', this.post.name, 'is_globally_pinned', cint(!this.is_pinned))\n\t\t\t\t\t.then(res => this.post.is_globally_pinned = cint(res.message.is_globally_pinned))\n\t\t\t}\n\t\t\tif (this.is_pinnable) {\n\t\t\t\tfrappe.db.set_value('Post', this.post.name, 'is_pinned', cint(!this.is_pinned))\n\t\t\t\t\t.then(res => this.post.is_pinned = cint(res.message.is_pinned))\n\t\t\t}\n\t\t},\n\t\tcreate_comment(content) {\n\t\t\tconst comment = frappe.model.get_new_doc('Post Comment');\n\t\t\tcomment.content = content\n\t\t\tcomment.parent = this.post.name;\n\t\t\tfrappe.db.insert(comment);\n\t\t},\n\t\tdelete_post() {\n\t\t\tfrappe.confirm(__(\"Are you sure you want to delete this post?\"), () => {\n\t\t\t\tfrappe.dom.freeze();\n\t\t\t\tfrappe.xcall('frappe.social.doctype.post.post.delete_post', {\n\t\t\t\t\t'post_name': this.post.name\n\t\t\t\t}).then(frappe.dom.unfreeze)\n\t\t\t})\n\t\t},\n\t\tupdate_seen() {\n\t\t\tfrappe.xcall('frappe.social.doctype.post.post.set_seen', {\n\t\t\t\tpost_name: this.post.name\n\t\t\t}).then(() => this.post.seen = true)\n\t\t},\n\t\tgenerate_preview(link_element) {\n\t\t\t// TODO: move the code to separate component\n\t\t\tfrappe.xcall('frappe.social.doctype.post.post.get_link_info', {\n\t\t\t\t'url': link_element.href\n\t\t\t}).then(info => {\n\t\t\t\tconst title = frappe.ellipsis(info['og:title'] || info['title'], 60)\n\t\t\t\tconst description = frappe.ellipsis(info['og:description'] || info['description'], 280)\n\t\t\t\tconst image = info['og:image'];\n\t\t\t\tconst url = info['og:url'];\n\n\t\t\t\tif (title) {\n\t\t\t\t\tlink_element.insertAdjacentHTML('afterend', `\n\t\t\t\t\t\t<a href=\"${url}\" target=\"blank\" class=\"preview-card\" class=\"flex\">\n\t\t\t\t\t\t\t<img src=\"${image}\"/>\n\t\t\t\t\t\t\t<div class=\"flex-column\">\n\t\t\t\t\t\t\t\t<h5>${title}</h5>\n\t\t\t\t\t\t\t\t<p class=\"text-muted\">${description}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t` );\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(console.error)\n\t\t}\n\t}\n}\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Post from './Post.vue';\nimport PostSkeleton from './PostSkeleton.vue';\n\nexport default {\n\tprops: ['post_list_filter'],\n\tcomponents: {\n\t\tPost,\n\t\tPostSkeleton\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tposts: [],\n\t\t\tmore_posts_available: true,\n\t\t\tloading_posts: false,\n\t\t\tload_new: false\n\t\t}\n\t},\n\tcreated() {\n\t\twindow.addEventListener('scroll', this.handle_scroll);\n\t\tthis.update_posts();\n\t\tthis.$parent.$on('load_new_posts', () => {\n\t\t\tthis.update_posts()\n\t\t})\n\t\tfrappe.realtime.on('global_pin', () => {\n\t\t\tthis.update_posts()\n\t\t})\n\t},\n\twatch: {\n\t\tpost_list_filter(old_val, new_val) {\n\t\t\tif (JSON.stringify(old_val) !== JSON.stringify(new_val)){\n\t\t\t\tthis.update_posts()\n\t\t\t}\n\t\t}\n\t},\n\tmethods: {\n\t\tget_posts(filters, load_old) {\n\t\t\treturn frappe.xcall('frappe.social.doctype.post.post.get_posts', {\n\t\t\t\tfilters,\n\t\t\t\tlimit_start: load_old ? this.posts.length : 0\n\t\t\t})\n\t\t},\n\t\tupdate_posts(load_old = false) {\n\t\t\tif (!this.post_list_filter) return\n\t\t\tthis.loading_posts = true;\n\n\t\t\tconst filters = Object.assign({}, this.post_list_filter);\n\n\t\t\tthis.get_posts(filters, load_old).then((res) => {\n\t\t\t\tif (load_old) {\n\t\t\t\t\tif (!res.length) {\n\t\t\t\t\t\tthis.more_posts_available = false;\n\t\t\t\t\t}\n\t\t\t\t\tthis.posts = this.posts.concat(res);\n\t\t\t\t} else {\n\t\t\t\t\tthis.posts = res;\n\t\t\t\t}\n\t\t\t}).finally(() => {\n\t\t\t\tthis.loading_posts = false;\n\t\t\t\tthis.track_seen()\n\t\t\t});\n\t\t},\n\t\thandle_scroll: frappe.utils.debounce(function() {\n\t\t\tthis.track_seen()\n\t\t\tconst screen_bottom = document.documentElement.scrollTop + window.innerHeight === document.documentElement.offsetHeight;\n\t\t\tif (screen_bottom && this.more_posts_available) {\n\t\t\t\tif (!this.loading_posts) {\n\t\t\t\t\tthis.update_posts(true);\n\t\t\t\t}\n\t\t\t}\n\t\t}, 500),\n\t\ttrack_seen() {\n\t\t\tconst posts = this.$refs.posts || []\n\t\t\tposts.forEach((post_component) => {\n\t\t\t\tif(!post_component.post.seen\n\t\t\t\t && frappe.dom.is_element_in_viewport(post_component.$el, 50)) {\n\t\t\t\t\tpost_component.update_seen()\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\tdelete_post(index) {\n\t\t\tthis.posts.splice(index, 1);\n\t\t},\n\t},\n\tdestroyed() {\n\t\twindow.removeEventListener('scroll', this.handle_scroll);\n\t}\n}\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tfrequently_visited_list: [],\n\t\t}\n\t},\n\tcreated() {\n\t\tthis.set_frequently_visited_list()\n\t},\n\tmethods: {\n\t\tgoto_list(route) {\n\t\t\tfrappe.set_route(route);\n\t\t},\n\t\tset_frequently_visited_list() {\n\t\t\tfrappe.xcall('frappe.social.doctype.post.post.frequently_visited_links')\n\t\t\t\t.then(data => {\n\t\t\t\t\tthis.frequently_visited_list = data;\n\t\t\t\t})\n\t\t},\n\t\tget_label(route) {\n\t\t\treturn frappe.utils.get_route_label(route);\n\t\t},\n\t\tgo_to_profile_page() {\n\t\t\tfrappe.set_route('social', 'profile', frappe.session.user)\n\t\t},\n\t\tgo_to_user_list() {\n\t\t\tfrappe.set_route('social', 'users')\n\t\t}\n\t}\n}\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\t'events': []\n\t\t}\n\t},\n\tcreated() {\n\t\tthis.get_events().then((events) => {\n\t\t\tthis.events = events\n\t\t})\n\t},\n\tmethods: {\n\t\tget_events() {\n\t\t\tconst today = frappe.datetime.now_date();\n\t\t\treturn frappe.xcall('frappe.desk.doctype.event.event.get_events', {\n\t\t\t\tstart: today,\n\t\t\t\tend: today\n\t\t\t})\n\t\t},\n\t\topen_chat() {\n\t\t\tsetTimeout(frappe.chat.widget.toggle);\n\t\t},\n\t\tget_time(timestamp) {\n\t\t\treturn frappe.datetime.get_time(timestamp)\n\t\t},\n\t\topen_event(event) {\n\t\t\tfrappe.set_route('Form', 'Event', event.name);\n\t\t}\n\t}\n}\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport PostLoader from '../components/PostLoader.vue';\nimport PostSidebar from '../components/PostSidebar.vue';\nimport ActivitySidebar from '../components/ActivitySidebar.vue';\n\nexport default {\n\tcomponents: {\n\t\tPostLoader,\n\t\tPostSidebar,\n\t\tActivitySidebar\n\t},\n\tdata() {\n\t\treturn {\n\t\t\t'posts': [],\n\t\t\t'events': [],\n\t\t\t'new_posts_count': 0,\n\t\t}\n\t},\n\tcreated() {\n\t\tfrappe.realtime.on('new_post', (post_owner) => {\n\t\t\tif (post_owner === frappe.session.user) {\n\t\t\t\tthis.load_new_posts()\n\t\t\t} else {\n\t\t\t\tthis.new_posts_count += 1;\n\t\t\t}\n\t\t})\n\t},\n\tmethods: {\n\t\tload_new_posts() {\n\t\t\tthis.$emit('load_new_posts');\n\t\t\tthis.new_posts_count = 0;\n\t\t}\n\t}\n};\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n\tprops: {\n\t\tuser_id: String\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tuser: frappe.user_info(this.user_id),\n\t\t\tcan_edit_profile: frappe.social.is_session_user_page(),\n\t\t\tcan_edit_user: frappe.session.user === this.user_id,\n\t\t\tenergy_points: 0\n\t\t};\n\t},\n\tmounted() {\n\t\tfrappe.xcall('frappe.social.doctype.energy_point_log.energy_point_log.get_user_energy_and_review_points', {user: this.user_id}).then(r => {\n\t\t\tthis.energy_points = r[this.user_id].energy_points;\n\t\t});\n\t},\n\tmethods: {\n\t\tedit_user() {\n\t\t\tfrappe.set_route('Form', 'User', this.user_id);\n\t\t},\n\t\tedit_profile() {\n\t\t\tconst edit_profile_dialog = new frappe.ui.Dialog({\n\t\t\t\ttitle: __('Edit Profile'),\n\t\t\t\tfields: [\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: 'Attach Image',\n\t\t\t\t\t\tfieldname: 'user_image',\n\t\t\t\t\t\tlabel: 'Profile Image',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: 'Data',\n\t\t\t\t\t\tfieldname: 'interest',\n\t\t\t\t\t\tlabel: 'Interests',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: 'Column Break'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: 'Attach Image',\n\t\t\t\t\t\tfieldname: 'banner_image',\n\t\t\t\t\t\tlabel: 'Banner Image',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: 'Data',\n\t\t\t\t\t\tfieldname: 'location',\n\t\t\t\t\t\tlabel: 'Location',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: 'Section Break',\n\t\t\t\t\t\tfieldname: 'Interest'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: 'Small Text',\n\t\t\t\t\t\tfieldname: 'bio',\n\t\t\t\t\t\tlabel: 'Bio',\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tprimary_action: values => {\n\t\t\t\t\tedit_profile_dialog.disable_primary_action();\n\t\t\t\t\tfrappe\n\t\t\t\t\t\t.xcall('frappe.core.doctype.user.user.update_profile_info', {\n\t\t\t\t\t\t\tprofile_info: values\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(user => {\n\t\t\t\t\t\t\tuser.image = user.user_image;\n\t\t\t\t\t\t\tlet user_info = frappe.user_info(this.user_id);\n\t\t\t\t\t\t\tthis.user = Object.assign(user_info, user);\n\t\t\t\t\t\t\tthis.$root.$emit('user_image_updated');\n\t\t\t\t\t\t\tedit_profile_dialog.hide();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.finally(() => {\n\t\t\t\t\t\t\tedit_profile_dialog.enable_primary_action();\n\t\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tprimary_action_label: __('Save')\n\t\t\t});\n\t\t\tedit_profile_dialog.set_values({\n\t\t\t\tuser_image: this.user.image,\n\t\t\t\tbanner_image: this.user.banner_image,\n\t\t\t\tlocation: this.user.location,\n\t\t\t\tinterest: this.user.interest,\n\t\t\t\tbio: this.user.bio\n\t\t\t});\n\t\t\tedit_profile_dialog.show();\n\t\t},\n\t\tview_energy_point_list(user) {\n\t\t\tfrappe.set_route('List', 'Energy Point Log', {user:user.name});\n\t\t}\n\t}\n};\n","//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n\tprops: ['user_id'],\n\tdata() {\n\t\treturn {\n\t\t\tuser_avatar: frappe.avatar(this.user_id, 'avatar-xl'),\n\t\t\tuser_banner: frappe.user_info(this.user_id).banner_image\n\t\t}\n\t},\n\tcreated() {\n\t\tthis.$root.$on('user_image_updated', () => {\n\t\t\tthis.user_avatar = frappe.avatar(this.user_id, 'avatar-xl')\n\t\t\tthis.user_banner = frappe.user_info(this.user_id).banner_image\n\t\t})\n\t},\n\tcomputed: {\n\t\tbackground_style() {\n\t\t\tconst style = {}\n\t\t\tif (this.user_banner) {\n\t\t\t\tstyle['background-image'] = `url('${this.user_banner}')`\n\t\t\t}\n\t\t\treturn style;\n\t\t}\n\t},\n}\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport PostLoader from '../components/PostLoader.vue';\nimport ProfileSidebar from '../components/ProfileSidebar.vue';\nimport ActivitySidebar from\t'../components/ActivitySidebar.vue';\nimport ProfileBanner from '../components/ProfileBanner.vue';\nexport default {\n\tprops: ['user_id'],\n\tcomponents: {\n\t\tPostLoader,\n\t\tProfileSidebar,\n\t\tProfileBanner,\n\t\tActivitySidebar\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tshow_list: 'user_posts',\n\t\t\tpost_list_filter : null,\n\t\t\tuser_posts_count: 0,\n\t\t\tliked_posts_count: 0,\n\t\t}\n\t},\n\twatch: {\n\t\tshow_list() {\n\t\t\tif (this.show_list == 'user_posts') {\n\t\t\t\tthis.post_list_filter = this.get_user_posts_filter();\n\t\t\t} else if (this.show_list == 'liked_posts') {\n\t\t\t\tthis.post_list_filter = this.get_liked_posts_filter();\n\t\t\t}\n\t\t}\n\t},\n\tcreated() {\n\t\tthis.post_list_filter = this.get_user_posts_filter();\n\t\tthis.set_post_count()\n\t},\n\tmethods: {\n\t\tget_user_posts_filter() {\n\t\t\treturn {\n\t\t\t\t'owner': this.user_id\n\t\t\t}\n\t\t},\n\t\tget_liked_posts_filter() {\n\t\t\treturn {\n\t\t\t\t'liked_by': ['like', '%' + this.user_id + '%']\n\t\t\t}\n\t\t},\n\t\tset_post_count() {\n\t\t\tfrappe.db.count('Post', { filters: this.get_user_posts_filter() })\n\t\t\t\t.then(count => this.user_posts_count = count)\n\n\t\t\tfrappe.db.count('Post', { filters: this.get_liked_posts_filter() })\n\t\t\t\t.then(count => this.liked_posts_count = count)\n\t\t}\n\t}\n}\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tusers: [],\n\t\t\tfilter_users_by: null,\n\t\t\tsort_users_by: 'energy_points',\n\t\t\tsort_order: 'desc',\n\t\t\tshow_log_for: null,\n\t\t\tperiod_options: ['Lifetime', 'This Month', 'This Week', 'Today'],\n\t\t\tperiod: 'This Month'\n\t\t};\n\t},\n\tcomputed: {\n\t\tfrom_date() {\n\t\t\tif (this.period === 'This Month') {\n\t\t\t\treturn frappe.datetime.month_start();\n\t\t\t}\n\t\t\tif (this.period === 'This Week') {\n\t\t\t\treturn frappe.datetime.week_start();\n\t\t\t}\n\t\t\tif (this.period === 'Today') {\n\t\t\t\treturn frappe.datetime.get_today();\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tfiltered_users() {\n\t\t\tlet filtered = this.users.slice();\n\t\t\tif (this.filter_users_by) {\n\t\t\t\tfiltered = filtered.filter(user =>\n\t\t\t\t\tuser.fullname\n\t\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t\t.includes(this.filter_users_by.toLowerCase())\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (this.sort_users_by) {\n\t\t\t\tfiltered.sort((a, b) => {\n\t\t\t\t\tconst value_a = a[this.sort_users_by];\n\t\t\t\t\tconst value_b = b[this.sort_users_by];\n\n\t\t\t\t\tlet return_value = 0;\n\t\t\t\t\tif (value_a > value_b) {\n\t\t\t\t\t\treturn_value = 1;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (value_a < value_b) {\n\t\t\t\t\t\treturn_value = -1;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.sort_order === 'desc') {\n\t\t\t\t\t\treturn_value = -return_value;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn return_value;\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn filtered;\n\t\t}\n\t},\n\twatch: {\n\t\tperiod() {\n\t\t\tthis.fetch_users_energy_points_and_update_users();\n\t\t}\n\t},\n\tmounted() {\n\t\t$('[data-toggle=\"tooltip\"]').tooltip();\n\t},\n\tcreated() {\n\t\tconst standard_users = ['Administrator', 'Guest', 'guest@example.com'];\n\t\tthis.users = frappe.boot.user_info;\n\t\t// delete standard users from the list\n\t\tstandard_users.forEach(user => delete this.users[user]);\n\t\tthis.users = Object.values(this.users);\n\t\tthis.fetch_users_energy_points_and_update_users();\n\t\tfrappe.realtime.on('update_points', () => {\n\t\t\tthis.fetch_users_energy_points_and_update_users();\n\t\t});\n\t},\n\tmethods: {\n\t\tget_avatar(user) {\n\t\t\treturn frappe.avatar(user, 'avatar-medium');\n\t\t},\n\t\tgo_to_profile_page(user) {\n\t\t\tfrappe.set_route('social', 'profile', user);\n\t\t},\n\t\tfetch_users_energy_points_and_update_users() {\n\t\t\tfrappe\n\t\t\t\t.xcall(\n\t\t\t\t\t'frappe.social.doctype.energy_point_log.energy_point_log.get_user_energy_and_review_points',\n\t\t\t\t\t{\n\t\t\t\t\t\tfrom_date: this.from_date\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t.then(data => {\n\t\t\t\t\tlet users = this.users.slice();\n\t\t\t\t\tthis.users = users.map(user => {\n\t\t\t\t\t\tconst points = data[user.name] || {};\n\t\t\t\t\t\tuser.energy_points = points.energy_points || 0;\n\t\t\t\t\t\tuser.review_points = points.review_points || 0;\n\t\t\t\t\t\tuser.given_points = points.given_points || 0;\n\t\t\t\t\t\treturn user;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t},\n\t\ttoggle_log(user) {\n\t\t\tfrappe.set_route('List', 'Energy Point Log', {user:user});\n\t\t}\n\t}\n};\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n\tprops: ['src'],\n\tdata() {\n\t\treturn {\n\t\t\tfull_size: false\n\t\t}\n\t},\n\tcreated() {\n\t\tdocument.addEventListener('keyup', this.close_preview_on_escape);\n\t},\n\tdestroyed() {\n\t\tdocument.removeEventListener('keyup', this.close_preview_on_escape);\n\t},\n\tmethods: {\n\t\tclose_preview_on_escape(e) {\n\t\t\tif (e.keyCode === 27) {\n\t\t\t\tthis.$root.$emit('hide_preview')\n\t\t\t}\n\t\t}\n\t}\n}\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\nimport Wall from './pages/Wall.vue';\nimport Profile from './pages/Profile.vue';\nimport UserList from './pages/UserList.vue';\nimport NotFound from './components/NotFound.vue';\nimport ImageViewer from './components/ImageViewer.vue';\n\nfunction get_route_map() {\n\treturn {\n\t\t'social/home': {\n\t\t\t'component': Wall,\n\t\t\t'props': {}\n\t\t},\n\t\t'social/profile/*': {\n\t\t\t'component': Profile,\n\t\t\t'props': {\n\t\t\t\t'user_id': frappe.get_route()[2],\n\t\t\t\t'key': frappe.get_route()[2]\n\t\t\t}\n\t\t},\n\t\t'social/users': {\n\t\t\t'component': UserList,\n\t\t\t'props': {}\n\t\t},\n\t\t'not_found': {\n\t\t\t'component': NotFound,\n\t\t}\n\t}\n}\n\nexport default {\n\tcomponents: {\n\t\tImageViewer\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tcurrent_page: this.get_current_page(),\n\t\t\tshow_preview: false,\n\t\t\tpreview_image_src: ''\n\t\t}\n\t},\n\tcreated() {\n\t\tthis.$root.$on('show_preview', (src) => {\n\t\t\tthis.preview_image_src = src;\n\t\t\tthis.show_preview = true;\n\t\t})\n\n\t\tthis.$root.$on('hide_preview', () => {\n\t\t\tthis.preview_image_src = '';\n\t\t\tthis.show_preview = false;\n\t\t})\n\n\t\tthis.update_primary_action(frappe.get_route()[1])\n\t},\n\tmounted() {\n\t\tfrappe.route.on('change', () => {\n\t\t\tif (frappe.get_route()[0] === 'social') {\n\t\t\t\tthis.set_current_page();\n\t\t\t\tthis.update_primary_action(frappe.get_route()[1])\n\t\t\t\tfrappe.utils.scroll_to(0);\n\t\t\t\t$(\"body\").attr(\"data-route\", frappe.get_route_str());\n\t\t\t}\n\t\t});\n\t\tfrappe.ui.setup_like_popover($(this.$refs.social), '.likes', false);\n\t},\n\tmethods: {\n\t\tset_current_page() {\n\t\t\tthis.current_page = this.get_current_page();\n\t\t},\n\t\tupdate_primary_action(current_route) {\n\t\t\tif (current_route === 'home') {\n\t\t\t\tthis.$root.page.set_title(__('Social'));\n\t\t\t\tfrappe.breadcrumbs.update();\n\t\t\t\tthis.$root.page.set_primary_action(__('Post'), () => {\n\t\t\t\t\tfrappe.social.post_dialog.show();\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tfrappe.breadcrumbs.add({\n\t\t\t\t\ttype: 'Custom',\n\t\t\t\t\tlabel: __('Social Home'),\n\t\t\t\t\troute: '#social/home'\n\t\t\t\t});\n\t\t\t\tthis.$root.page.clear_primary_action();\n\t\t\t}\n\n\t\t\tif (current_route === 'users') {\n\t\t\t\tthis.$root.page.set_title(__('Leaderboard'));\n\t\t\t}\n\t\t},\n\t\tget_current_page() {\n\t\t\tconst route_map = get_route_map();\n\t\t\tconst route = frappe.get_route_str();\n\t\t\tif (route_map[route]) {\n\t\t\t\treturn route_map[route];\n\t\t\t} else {\n\t\t\t\treturn route_map[route.substring(0, route.lastIndexOf('/')) + '/*'] || route_map['not_found']\n\t\t\t}\n\t\t},\n\t}\n}\n","import Home from './Home.vue';\n\nfrappe.provide('frappe.social');\n\nfrappe.social.Home = class SocialHome {\n\tconstructor({ parent }) {\n\t\tthis.$parent = $(parent);\n\t\tthis.page = parent.page;\n\t\tthis.setup_header();\n\t\tthis.make_body();\n\t}\n\tmake_body() {\n\t\tthis.$social_container = this.$parent.find('.layout-main');\n\t\tnew Vue({\n\t\t\tel: this.$social_container[0],\n\t\t\trender: h => h(Home),\n\t\t\tdata: {\n\t\t\t\t'page': this.page\n\t\t\t}\n\t\t});\n\t}\n\tsetup_header() {\n\t\tthis.page.set_title(__('Social'));\n\t}\n};\n\nfrappe.social.post_dialog = new frappe.ui.Dialog({\n\ttitle: __('Create Post'),\n\tfields: [\n\t\t{\n\t\t\tfieldtype: \"Text Editor\",\n\t\t\tfieldname: \"content\",\n\t\t\tlabel: __(\"Content\"),\n\t\t\treqd: 1\n\t\t}\n\t],\n\tprimary_action_label: __('Post'),\n\tprimary_action: (values) => {\n\t\tfrappe.social.post_dialog.disable_primary_action();\n\t\tconst post = frappe.model.get_new_doc('Post');\n\t\tpost.content = values.content;\n\t\tfrappe.db.insert(post).then(() => {\n\t\t\tfrappe.social.post_dialog.clear();\n\t\t\tfrappe.social.post_dialog.hide();\n\t\t}).finally(() => {\n\t\t\tfrappe.social.post_dialog.enable_primary_action();\n\t\t});\n\t}\n});\n\nfrappe.social.is_home_page = () => {\n\treturn frappe.get_route()[0] === 'social' && frappe.get_route()[1] === 'home';\n};\n\nfrappe.social.is_profile_page = (user) => {\n\treturn frappe.get_route()[0] === 'social'\n\t\t&& frappe.get_route()[1] === 'profile'\n\t\t&& (user ? frappe.get_route()[2] === user : true);\n};\n\nfrappe.social.is_session_user_page = () => {\n\treturn frappe.social.is_profile_page() && frappe.get_route()[2] === frappe.session.user;\n};\n\nfrappe.provide('frappe.app_updates');\n\nfrappe.utils.make_event_emitter(frappe.app_updates);\n"],"names":["props","computed","like_count","this","split_string","liked_by","length","post_liked","includes","frappe","session","user","liked_by_data","JSON","stringify","methods","str","split","mounted","make_comment_section","make_mentions_clickable","$refs","get_avatar","avatar","get_time","timestamp","comment_when","go_to_profile_page","set_route","comment_section","ui","form","make_control","parent","only_input","render_input","no_wrapper","mentions","get_names_for_mentions","df","fieldtype","fieldname","on_submit","create_comment","bind","const","message","get_value","replace","strip_html","utils","play_sound","$emit","clear","valid_users","Object","keys","boot","user_info","filter","allowed_in_mentions","map","name","parent_element","Array","from","getElementsByClassName","forEach","mention","classList","add","addEventListener","dataset","value","components","PostAction","PostComment","data","user_avatar","post","owner","post_time","creation","user_name","fullname","comment_count","comments","show_comments","is_globally_pinnable","user_roles","social","is_home_page","is_pinnable","is_user_post_owner","can_pin","is_pinned","is_globally_pinned","options","push","label","__","action","toggle_pin","delete_post","created","db","get_list","fields","order_by","filters","then","$set","realtime","on","comment","concat","update_liked_by","$root","$on","querySelectorAll","img","src","link_element","target","generate_preview","goto_profile","toggle_comment","toggle_like","xcall","post_name","set_value","cint","res","content","model","get_new_doc","insert","confirm","dom","freeze","unfreeze","update_seen","seen","url","href","info","title","ellipsis","description","image","insertAdjacentHTML","catch","console","error","Post","posts","more_posts_available","loading_posts","load_new","window","handle_scroll","update_posts","$parent","watch","post_list_filter","old_val","new_val","get_posts","load_old","limit_start","assign","finally","track_seen","debounce","document","documentElement","scrollTop","innerHeight","offsetHeight","post_component","is_element_in_viewport","$el","index","splice","destroyed","removeEventListener","frequently_visited_list","set_frequently_visited_list","goto_list","route","get_label","get_route_label","go_to_user_list","events","get_events","today","datetime","now_date","start","end","open_chat","setTimeout","chat","widget","toggle","open_event","event","PostLoader","PostSidebar","ActivitySidebar","new_posts_count","post_owner","load_new_posts","user_id","String","can_edit_profile","is_session_user_page","can_edit_user","energy_points","r","edit_user","edit_profile","edit_profile_dialog","Dialog","primary_action","values","disable_primary_action","profile_info","user_image","let","hide","enable_primary_action","primary_action_label","set_values","banner_image","location","interest","bio","show","view_energy_point_list","user_banner","background_style","style","ProfileSidebar","show_list","user_posts_count","liked_posts_count","get_user_posts_filter","get_liked_posts_filter","set_post_count","count","users","filter_users_by","sort_users_by","sort_order","show_log_for","period_options","period","from_date","month_start","week_start","get_today","filtered_users","filtered","slice","toLowerCase","sort","a","b","value_a","value_b","return_value","fetch_users_energy_points_and_update_users","$","tooltip","points","review_points","given_points","toggle_log","full_size","close_preview_on_escape","e","keyCode","current_page","get_current_page","show_preview","preview_image_src","update_primary_action","get_route","set_current_page","scroll_to","attr","get_route_str","setup_like_popover","current_route","page","set_title","breadcrumbs","update","set_primary_action","post_dialog","type","clear_primary_action","route_map","social/home","component","Wall","social/profile/*","Profile","key","social/users","UserList","not_found","NotFound","substring","lastIndexOf","provide","Home","[object Object]","ref","setup_header","make_body","$social_container","find","Vue","el","render","h","reqd","is_profile_page","make_event_emitter","app_updates"],"mappings":"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"}