!function(){"use strict";window.erpnext||(window.erpnext={}),frappe.send_message=function(e,t){return frappe.call({type:"POST",method:"erpnext.templates.utils.send_message",btn:t,args:e,callback:e.callback})},erpnext.subscribe_to_newsletter=function(e,t){return frappe.call({type:"POST",method:"frappe.email.doctype.newsletter.newsletter.subscribe",btn:t,args:{email:e.email},callback:e.callback})},erpnext.send_message=frappe.send_message,frappe.provide("erpnext.shopping_cart");var e=erpnext.shopping_cart;frappe.ready(function(){var t=frappe.session&&frappe.session.user_fullname;t&&$('.navbar li[data-label="User"] a').html('<i class="fa fa-fixed-width fa fa-user"></i> '+t);var a=function(e){var t=[],a=document.createElement("a");a.href=e;for(var n=a.search.substring(1).split("&"),r=0;r<n.length;r++){var o=n[r].split("=");t[o[0]]=decodeURIComponent(o[1])}return t}(window.location.href),n=a.cc,r=a.sp,o=new Date;o.setTime(o.getTime()+.48*60*60*1e3);var s="expires="+o.toUTCString();n&&(document.cookie="referral_coupon_code="+n+";"+s+";path=/"),r&&(document.cookie="referral_sales_partner="+r+";"+s+";path=/"),n=frappe.get_cookie("referral_coupon_code"),r=frappe.get_cookie("referral_sales_partner"),n&&null==$(".tot_quotation_discount").val()&&$(".txtcoupon").val(n),r&&$(".txtreferral_sales_partner").val(r),e.show_shoppingcart_dropdown(),e.set_cart_count(),e.bind_dropdown_cart_buttons(),e.show_cart_navbar()}),$.extend(e,{show_shoppingcart_dropdown:function(){$(".shopping-cart").on("shown.bs.dropdown",function(){if(!$(".shopping-cart-menu .cart-container").length)return frappe.call({method:"erpnext.shopping_cart.cart.get_shopping_cart_menu",callback:function(e){e.message&&$(".shopping-cart-menu").html(e.message)}})})},update_cart:function(t){if("Guest"!==frappe.session.user)return frappe.call({type:"POST",method:"erpnext.shopping_cart.cart.update_cart",args:{item_code:t.item_code,qty:t.qty,additional_notes:void 0!==t.additional_notes?t.additional_notes:void 0,with_items:t.with_items||0},btn:t.btn,callback:function(a){e.set_cart_count(),a.message.shopping_cart_menu&&$(".shopping-cart-menu").html(a.message.shopping_cart_menu),t.callback&&t.callback(a)}});localStorage&&localStorage.setItem("last_visited",window.location.pathname),window.location.href="/login"},set_cart_count:function(){var e=frappe.get_cookie("cart_count");"Guest"===frappe.session.user&&(e=0),e&&$(".shopping-cart").toggleClass("hidden",!1);var t=$(".cart-icon"),a=t.find("#cart-count");0===parseInt(e)||void 0===e?(t.css("display","none"),$(".cart-items").html("Cart is Empty"),$(".cart-tax-items").hide(),$(".btn-place-order").hide(),$(".cart-addresses").hide()):t.css("display","inline"),e?a.html(e):a.remove()},shopping_cart_update:function(t){var a=t.item_code,n=t.qty,r=t.cart_dropdown,o=t.additional_notes;frappe.freeze(),e.update_cart({item_code:a,qty:n,additional_notes:o,with_items:1,btn:this,callback:function(e){frappe.unfreeze(),e.exc||($(".cart-items").html(e.message.items),$(".cart-tax-items").html(e.message.taxes),1!=r&&$(".cart-icon").hide())}})},bind_dropdown_cart_buttons:function(){$(".cart-icon").on("click",".number-spinner button",function(){var t=$(this),a=t.closest(".number-spinner").find("input"),n=a.val().trim(),r=0;"up"==t.attr("data-dir")?r=parseInt(n)+1:n>1&&(r=parseInt(n)-1),a.val(r);var o=a.attr("data-item-code");return e.shopping_cart_update({item_code:o,qty:r,cart_dropdown:!0}),!1})},show_cart_navbar:function(){frappe.call({method:"erpnext.shopping_cart.doctype.shopping_cart_settings.shopping_cart_settings.is_cart_enabled",callback:function(e){$(".shopping-cart").toggleClass("hidden",!e.message)}})}})}();
//# sourceMappingURL=erpnext-web.min.js.map
