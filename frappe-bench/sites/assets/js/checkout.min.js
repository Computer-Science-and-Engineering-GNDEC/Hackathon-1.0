!function(){"use strict";frappe.provide("frappe.checkout"),frappe.require("https://checkout.razorpay.com/v1/checkout.js").then(function(){frappe.checkout.razorpay=class{constructor(r){Object.assign(this,r)}init(){var r=this;frappe.run_serially([function(){return r.get_key()},function(){return r.make_order()},function(){return r.prepare_options()},function(){return r.setup_handler()},function(){return r.show()}])}show(){var r=this;this.razorpay=new Razorpay(this.options),this.razorpay.once("ready",function(e){r.on_open&&r.on_open(e)}),this.razorpay.open()}get_key(){var r=this;return new Promise(function(e){frappe.call("frappe.integrations.doctype.razorpay_settings.razorpay_settings.get_api_key").then(function(t){r.key=t.message,e(!0)})})}make_order(){var r=this;return new Promise(function(e){frappe.call("frappe.integrations.doctype.razorpay_settings.razorpay_settings.get_order",{doctype:r.doctype,docname:r.docname}).then(function(t){r.order=t.message,e(!0)})})}order_success(r){frappe.call("frappe.integrations.doctype.razorpay_settings.razorpay_settings.order_payment_success",{integration_request:this.order.integration_request,params:{razorpay_payment_id:r.razorpay_payment_id,razorpay_order_id:r.razorpay_order_id,razorpay_signature:r.razorpay_signature}})}order_fail(r){frappe.call("frappe.integrations.doctype.razorpay_settings.razorpay_settings.order_payment_failure",{integration_request:this.order.integration_request,params:r})}prepare_options(){this.options={key:this.key,amount:this.order.amount_due,currency:this.order.currency,name:this.name,description:this.description,image:this.image,order_id:this.order.id,prefill:this.prefill,theme:this.theme,modal:this.modal}}setup_handler(){var r=this;this.options.handler=function(e){e.error?(r.order_fail(e),r.on_fail&&r.on_fail(e)):e.razorpay_payment_id&&(r.order_success(e),r.on_success&&r.on_success(e))}}}})}();
//# sourceMappingURL=checkout.min.js.map
